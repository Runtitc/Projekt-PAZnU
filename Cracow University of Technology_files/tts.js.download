(function(a){a.frTTSEngine=function(d){var i;var B;var b;var n;var h;var k;var x;var f;var l;var c;var t=new Array();var s=null;var z=0;var y={"en-US":"US English Female","en-AU":"Australian Female","en-GB":"UK English Female",en:"UK English Female","es-ES":"Spanish Female",es:"Spanish Female","fr-FR":"French Female",fr:"French Female","de-DE":"Deutsch Female",de:"Deutsch Female","it-IT":"Italian Female",it:"Italian Female","el-GR":"Greek Male",el:"Greek Male","hu-HU":"Hungarian Female",hu:"Hungarian Female","tr-TR":"Turkish Female",tr:"Turkish Female","ru-RU":"Russian Female",ru:"Russian Female","nl-BE":"Dutch Female","nl-NL":"Dutch Female",nl:"Dutch Female","sv-FI":"Swedish Female","sv-SE":"Swedish Female",sv:"Swedish Female","nb-NO":"Norwegian Female",nb:"Norwegian Female","ja-JP":"Japanese Female",ja:"Japanese Female","ko-KR":"Korean Female",ko:"Korean Female","zh-CN":"Chinese Female","zh-HK":"Chinese Female","zh-MO":"Chinese Female","zh-SG":"Chinese Female","zh-TW":"Chinese Female",zh:"Chinese Female","hi-IN":"Hindi Female",hi:"Hindi Female","sr-BA":"Serbian Male","sr-SP":"Serbian Male",sr:"Serbian Male","hr-BA":"Croatian Male","hr-HR":"Croatian Male",hr:"Croatian Male","bs-BA":"Bosnian Male",bs:"Bosnian Male","ro-RO":"Romanian Male",ro:"Romanian Male","ca-ES":"Catalan Male",ca:"Catalan Male","fi-FI":"Finnish Female",fi:"Finnish Female","af-ZA":"Afrikaans Male",af:"Afrikaans Male","sq-AL":"Albanian Male",sq:"Albanian Male","ar-AR":"Arabic Male","ar-AE":"Arabic Male","ar-AA":"Arabic Male",ar:"Arabic Male","hy-AM":"Armenian Male",hy:"Armenian Male","cs-CZ":"Czech Female",cs:"Czech Female","da-DK":"Danish Female",da:"Danish Female",eo:"Esperanto Male","is-IS":"Icelandic Male",is:"Icelandic Male","id-ID":"Indonesian Female",id:"Indonesian Female","lv-LV":"Latvian Male",lv:"Latvian Male","mk-MK":"Macedonian Male",mk:"Macedonian Male","pl-PL":"Polish Female",pl:"Polish Female","pt-BR":"Brazilian Portuguese Female","pt-PT":"Portuguese Female",pt:"Portuguese Female","sk-SK":"Slovak Female",sk:"Slovak Female","sw-KE":"Swahili Male",sw:"Swahili Male","ta-IN":"Tamil Male",ta:"Tamil Male","th-TH":"Thai Female",th:"Thai Female","vi-VN":"Vietnamese Male",vi:"Vietnamese Male","cy-GB":"Welsh Male",cy:"Welsh Male"};function e(E){h=0;k=A(h+x);firstChunk=n.substring(h,k);if(firstChunk.length){soundManager.createSound({id:"chunkSound",url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&engine_token="+c.engineToken+"&token="+c.token+"&text="+encodeURIComponent(firstChunk),autoLoad:false,type:"audio/mp3"});soundManager.play("chunkSound",{onfinish:function(){soundManager.destroySound("chunkSound");if(t.length){if(c.preload){m(t)}else{p(t)}}else{g("finished");return}}});s="chunkSound";soundManager.setVolume(s,c.screenReaderVolume)}else{g("notext");return}if(n.substr(k)&&c.preload){var D=0;var C=function(){h=k;k=A(h+x);E=n.substring(h,k);var F=soundManager.createSound({id:"chunkSound"+D,url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&engine_token="+c.engineToken+"&token="+c.token+"&text="+encodeURIComponent(E),autoLoad:false,type:"audio/mp3"});F.load();t.push(F);D++;if(n.substr(k)){b=setTimeout(function(){if(B!=="stop"){C()}},3000)}};b=setTimeout(function(){if(B!=="stop"){C()}},3000)}else{if(n.substr(k)){var D=0;while(n.substr(k)){h=k;k=A(h+x);E=n.substring(h,k);t.push(E);D++}}}}function m(D){var C=D.splice(0,1);if(a.isArray(C)&&C.length){soundManager.play(C[0]["id"],{onfinish:function(){soundManager.destroySound(C[0]["id"]);m(D)}});s=C[0]["id"];soundManager.setVolume(s,c.screenReaderVolume)}else{g("finished");return}}function p(F){var D=F.splice(0,1);var C="chunkSound"+z;if(a.isArray(D)&&D.length){var E=soundManager.createSound({id:C,url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&engine_token="+c.engineToken+"&token="+c.token+"&text="+encodeURIComponent(D[0]),autoLoad:false,type:"audio/mp3"});soundManager.play(C,{onfinish:function(){soundManager.destroySound(C);p(F)}});s=C;soundManager.setVolume(s,c.screenReaderVolume);z++}else{g("finished");return}}function j(){soundManager.stopAll();soundManager.destroySound("chunkSound");a.each(soundManager.sounds,function(C,D){soundManager.destroySound(D.id)});t=new Array();s=null}function A(E){if(n.charAt(E)==" "){return E}var D=n.substr(E);if(D.indexOf(" ")==-1){var C=D.length+E;return C}else{var F=D.indexOf(" ")+E;return F}}function r(){var C=a("#volume_plugin");var G=c.screenReaderVolume/20;var E=5;for(var D=0;D<E;D++){var F=!!(D<G)?" active":"";a(C).append('<div id="volume_step'+(D+1)+'" class="volume_step'+F+'" data-value="'+parseInt((D+1)*20)+'" accesskey="'+(D+1)+'"></div>')}}function q(){var E="";if(window.getSelection){E=window.getSelection().toString()}else{if(document.selection&&document.selection.type!="Control"){E=document.selection.createRange().text}}if(!!c.readPage&&!E){if(!!c.readChildNodes){if(c.excludeScripts){var F=a(c.mainpageSelector).clone().find("script").remove().end().filter(function(){if(this.nodeName&&this.nodeName.toLowerCase()=="script"){return false}return true});E=a.trim(a(F).text())}else{E=a.trim(a(c.mainpageSelector).text())}if(c.readImages){var C="";var D=a(F).find("img");a.each(D,function(H,I){var G=a(I).attr(c.readImagesAttribute);if(G){C+=G}});if(c.readImagesOrdering=="before"){E=C+E}else{E=E;+C}}}else{E=a.trim(a(c.mainpageSelector).immediateText())}}E=E.replace(/[\n\r\t]/g," ");E=E.replace(/\s+/g," ");return E}function w(E){var D=E+"=";var C=document.cookie.split(";");for(var F=0;F<C.length;F++){var G=C[F];while(G.charAt(0)==" "){G=G.substring(1)}if(G.indexOf(D)==0){return G.substring(D.length,G.length)}}return false}function u(){if(c.readerEngine=="proxy_responsive"){if(f in y){f=y[f];responsiveVoice.setDefaultVoice(f)}}}function g(C){switch(C){case"playing":a("div#tts_message").remove();a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="playicon"></div>');a("#playicon").css("background-color",c.toolbarBgcolor);break;case"paused":a("div#tts_message").remove();a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="msgtext">'+fr_paused+"</div>");break;case"finished":s=null;a("div#tts_message").fadeOut(500,function(){a(this).remove()});break;case"notext":a("div#tts_message").remove();a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="msgtext">'+fr_notext+"</div>").delay(1500).fadeOut(500,function(){a(this).remove()});break}}function o(){a(document).on("click.frTTS","#fr_screenreader_play",function(C){i=true;B="play";clearTimeout(b);n=q();if(!n.length){g("notext")}else{j();if(c.readerEngine=="proxy_responsive"){responsiveVoice.speak(n,f,{volume:(c.screenReaderVolume/100),onend:function(){g("finished")}})}else{e()}g("playing")}a("#fr_screenreader_pause").removeClass("active");C.stopPropagation();C.preventDefault()});a(document).on("click.frTTS","#fr_screenreader_pause",function(C){if(!s&&c.readerEngine!="proxy_responsive"){return}switch(i){case true:i=false;B="pause";if(c.readerEngine=="proxy_responsive"){responsiveVoice.pause()}else{soundManager.pause(s)}g("paused");a(this).addClass("active");break;case false:i=true;B="play";if(c.readerEngine=="proxy_responsive"){responsiveVoice.resume()}else{soundManager.resume(s)}g("playing");a(this).removeClass("active");break}});a(document).on("click.frTTS","#fr_screenreader_stop",function(C){i=false;B="stop";clearTimeout(b);a("#fr_screenreader_pause").removeClass("active");if(c.readerEngine=="proxy_responsive"){responsiveVoice.cancel()}else{j()}g("finished")});a(document).on("click.frTTS","div.volume_step",function(C){a(this).siblings("div").removeClass("active");a(this).prevAll("div").addClass("active");a(this).addClass("active");soundManager.setVolume(s,parseInt(a(this).attr("data-value")));c.screenReaderVolume=a(this).attr("data-value")});if(c.gtranslateIntegration){a('select[onchange*="GTranslate"]').on("change",function(D){var E=a(this).val();if(E){var C=E.split("|");f=C[1];u()}});a('a[onclick*="GTranslate"]').on("click",function(C){setTimeout(function(){if(w("googtrans")){var D=w("googtrans").split("/");if(D[2]){f=D[2];u()}}else{f=l;u()}},500)})}}(function v(){a.fn.extend({immediateText:function(){return this.clone().find("*").remove().end().text()}});var F=this;i=false;B="stop";var D={baseURI:null,toolbarBgcolor:"#EEE",token:null,langCode:"en",chunkLength:80,screenReaderVolume:80,preload:0,readPage:1,readChildNodes:1,excludeScripts:1,readImages:0,readImagesAttribute:"alt",readImagesOrdering:"before",mainpageSelector:"*[name*=main], *[class*=main], *[id*=main], *[id*=container], *[class*=container]",readerEngine:"proxy_virtual",engineToken:0,gtranslateIntegration:0};c=a.extend({},D,d);if(c.readerEngine=="proxy_fallback"){a.getJSON("https://api.naturalreaders.com/v2/auth/requesttoken?callback=?",{appid:"de52ydkplza",appsecret:"g13pqbr77k84cggw4oscsggwcos8sco"},null).always(function(I,H,J){if(H=="success"&&I.rst=="true"){c.engineToken=I.requesttoken}})}var G=new Image();G.src=c.baseURI+"plugins/system/screenreader/screenreader/libraries/controller/css/images/waves.gif";f=c.langCode;l=f;if(c.gtranslateIntegration&&w("googtrans")){var E=w("googtrans").split("/");if(E[2]){f=E[2]}}if(c.readerEngine=="proxy_responsive"){if(f in y){f=y[f];responsiveVoice.setDefaultVoice(f)}}x=c.chunkLength;var C=function(){var J=!!("ontouchstart" in window);var H=!!(navigator.msMaxTouchPoints);var I=J||H;return I};if(C()){c.preload=0}r();if(c.template=="custom.css"){a("#volume_plugin").css("background",c.toolbarBgcolor)}o()}).call(this);this.getState=function(){return i}}})(jQuery);